\[
	\boxed{\text{All constraints in this subsection further assume } \oobInstIsBlsGOneMsm + \oobInstIsBlsGTwoMsm  = 1}
\]

We use the shorthands defined below:
\[
	\left\{ \begin{array}{lclr}
		\locCalleeGas    & \define & \oobDataCol {1} _{i} \\
		\locCds          & \define & \oobDataCol {2} _{i} \\
		%                & \define & \oobDataCol {3} _{i} \\
		\locHubSuccess   & \define & \oobDataCol {4} _{i}  & \prediction \\
		\locReturnGas    & \define & \oobDataCol {5} _{i} \\
		%                & \define & \oobDataCol {6} _{i} \\
		%                & \define & \oobDataCol {7} _{i} \\
		%                & \define & \oobDataCol {8} _{i}  & \prediction \\
	\end{array} \right.
\]
\saNote{} The decorator `` $\prediction{}$ '' stands for ``\hubMod{} prediction.''

We impose the following constraints:
\begin{description}
	\item[\underline{Row n°$(i + 2)$:}]
		we impose that
		\[
			\oobCallToMod
			{i}{2}
			{0}{\locCds}
			{0}{\locMsmSize_{i}}
		\]
		and we define the following shorthand
		\[
			\locRemainder \define \outgoingResLo_{i + 2}
		\]
	\item[\underline{Row n°$(i + 3)$:}]
		we impose that
		\[
			\oobCallToIszero
			{i}{3}
			{0}{\locRemainder}
		\]
		and we define the following shorthand
		\[
			\left\{ \begin{array}{lcl}
				\locMsmSizeIsMultiple & \define & \outgoingResLo_{i + 3} \\
				\locNumberOfInputs    & \define & \locCds / \locMsmSize_{i}  \\
			\end{array} \right.
		\]
		\saNote{} The shorthand \locNumberOfInputs{} was defined using a division by \locMsmSize{}. Whenever this shorthand is used in the constraints, we can replace the division by \locMsmSize{} with a multiplication by the same number through same basic algebra. This is the approach taken in the implementation to avoid division.
	\item[\underline{Row n°$(i + 4)$:}]
		we impose that
		\begin{enumerate}
			\item \If $\locMsmSizeIsMultiple = 0$ \Then we impose $\oobNoCall{i}{4}$.
			\item \If $\locMsmSizeIsMultiple = 1$ \Then we impose that
				\[
					\oobCallToGt
					{i}{4}
					{0}{\locNumberOfInputs}
					{0}{128}
				\]
				and we define the following shorthand
				\[
					\locNumberOfMsmInputsLeqThreshold \define 1 - \outgoingResLo_{i + 4}
				\]
		\end{enumerate}
	\item[\underline{Row n°$(i + 5)$:}]
		we impose that
		\begin{enumerate}
			\item \If $\locMsmSizeIsMultiple = 0$ \Then we impose $\oobNoCall{i}{4}$.
			\item \If $\locMsmSizeIsMultiple = 1$ \Then we impose that
				\begin{enumerate}
					\item \If $\locNumberOfMsmInputsLeqThreshold = 1$ \Then we impose that
						\[
							\oobCallToBlsRefTable
							{i}{5}
							{\weightedPrcFlagSumBls_{i}}{\locNumberOfInputs}
						\]
						and we define the following shorthand
						\[
							\locDiscount \define \outgoingResLo_{i + 5}
						\]
				    \item \If $\locNumberOfMsmInputsLeqThreshold = 0$ \Then we impose $\oobNoCall{i}{5}$
						and we define the following shorthand
						\[
							\locDiscount \define \locMaxDiscount_{i}
						\]
				\end{enumerate}
				
		\end{enumerate}
	\item[\underline{Row n°$(i + 5)$:}]
		we impose that
		\begin{enumerate}
			\item \If $\locMsmSizeIsMultiple = 0$ \Then we impose $\oobNoCall{i}{5}$.
			\item \If $\locMsmSizeIsMultiple = 1$ \Then we impose that
				\[
					\oobCallToLt
					{i}{5}
					{0}{\locCalleeGas}
					{0}{\locPrecompileCost}
				\]
				where we use the following shorthand
				\[
					\locPrecompileCost \define \locNumberOfInputs \cdot \locMsmMultiplicationCost_{i} \cdot \frac{\locDiscount}{\prcBlsMultiplicationMultiplier}
				\]
				we further introduce the following shorthand
				\[
					\locInsufficientGas \define \outgoingResLo_{i + 5}
				\]
				It follows that $\locCalleeGas < \locPrecompileCost \iff \locInsufficientGas = 1$.
		\end{enumerate}
		\saNote{} The shorthand \locPrecompileCost{} was defined using a division by \prcBlsMultiplicationMultiplier{}. Whenever this shorthand is used in the constraints, we can replace the division by \prcBlsMultiplicationMultiplier{} with a multiplication by the same number through same basic algebra. This is the approach taken in the implementation to avoid division.
	\item[\underline{Justifying the remaining \hubMod{} predictions:}]
		we impose that
		\[
			\locHubSuccess =
			\locMsmSizeIsMultiple \cdot
			(1 - \locInsufficientGas)
		\]
		we further impose that
		\begin{enumerate}
			\item \If $\locHubSuccess = 0$ \Then $\locReturnGas = 0$
			\item \If $\locHubSuccess = 1$ \Then $\locReturnGas = \locCalleeGas - \locPrecompileCost$
		\end{enumerate}
\end{description}