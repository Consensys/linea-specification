% !TeX TS-program = lualatex
\documentclass[varwidth=\maxdimen,margin=0.5cm,multi={verbatim}]{standalone}

\usepackage{fontspec}
\directlua{luaotfload.add_fallback ("emojifallback", { "NotoColorEmoji:mode=harf;" })}

\setmonofont{JetBrains Mono NL Regular}[RawFeature={fallback=emojifallback}]

\usepackage{../../pkg/draculatheme}

\begin{document}
\begin{verbatim}

| φ_SEL | φ_USER_TXN_NUMBER | φ_TUPLE_INDEX | φ_shifted_code_prefix       | φ_shifted_xtern/ADDRESS_HI   | φ_shifted_xtern/ADDRESS_LO | φ_xtern/CODE_HASH_HI | φ_xtern/CODE_HASH_LO |
|:-----:+:-----------------:+:-------------:+:----------------------------+------------------------------+----------------------------+----------------------+----------------------|
|   ⋮   |                   |               |                             |                              |                            |                      |                      |
|   0   |                   |               |                             |                              |                            |                      |                      |
|   1   |         13        |       0       | 0x ef0001.................. | 0x <addr_hi>................ | 0x <addr_lo>               | <keccak_hi>          | <keccak_lo>          |
|   1   |         13        |       1       | 0x ef0001.................. | 0x <addr_hi>................ | 0x <addr_lo>               | <keccak_hi>          | <keccak_lo>          |
|   1   |         13        |       7       | 0x ef0001.................. | 0x <addr_hi>................ | 0x <addr_lo>               | <keccak_hi>          | <keccak_lo>          |
|   1   |         13        |       8       | 0x ef0001.................. | 0x <addr_hi>................ | 0x <addr_lo>               | <keccak_hi>          | <keccak_lo>          |
|   1   |         13        |       39      | 0x ef0001.................. | 0x <addr_hi>................ | 0x <addr_lo>               | <keccak_hi>          | <keccak_lo>          |
|-------+-------------------+---------------+-----------------------------+------------------------------+----------------------------+----------------------+----------------------|
|   1   |         66        |       0       | 0x ef0001.................. | 0x <addr_hi>................ | 0x <addr_lo>               | <keccak_hi>          | <keccak_lo>          |
|   1   |         66        |       1       | 0x ef0001.................. | 0x <addr_hi>................ | 0x <addr_lo>               | <keccak_hi>          | <keccak_lo>          |
|   1   |         66        |       2       | 0x ef0001.................. | 0x <addr_hi>................ | 0x <addr_lo>               | <keccak_hi>          | <keccak_lo>          |
|   1   |         66        |       3       | 0x ef0001.................. | 0x <addr_hi>................ | 0x <addr_lo>               | <keccak_hi>          | <keccak_lo>          |
|   1   |         66        |       4       | 0x ef0001.................. | 0x <addr_hi>................ | 0x <addr_lo>               | <keccak_hi>          | <keccak_lo>          |
|   1   |         66        |       5       | 0x ef0001.................. | 0x <addr_hi>................ | 0x <addr_lo>               | <keccak_hi>          | <keccak_lo>          |
|   1   |         66        |       6       | 0x ef0001.................. | 0x <addr_hi>................ | 0x <addr_lo>               | <keccak_hi>          | <keccak_lo>          |
|-------+-------------------+---------------+-----------------------------+------------------------------+----------------------------+----------------------+----------------------|
|   1   |        198        |       21      | 0x ef0001.................. | 0x <addr_hi>................ | 0x <addr_lo>               | <keccak_hi>          | <keccak_lo>          |
|   1   |        198        |       22      | 0x ef0001.................. | 0x <addr_hi>................ | 0x <addr_lo>               | <keccak_hi>          | <keccak_lo>          |
|-------+-------------------+---------------+-----------------------------+------------------------------+----------------------------+----------------------+----------------------|
|   0   |                   |               |                             |                              |                            |                      |                      |
|   ⋮   |                   |               |                             |                              |                            |                      |                      |

NOTE. We write φ_XXX for the appropriately selector-filtered column XXX, i.e. φ_XXX ≡ sel ∙ XXX
NOTE. As per usual, '.' in a limb stands for 0. All 'limbs' are thus left aligned on the 16-th byte.
NOTE. When nontrivial,

* φ_shifted_code_prefix      ≡ 3 data bytes (always 0xef0001, left aligned on the 16th byte)
* φ_shifted_xtern/ADDRESS_HI ≡ 4 data bytes
* φ_shifted_xtern/ADDRESS_LO ≡ 16 data bytes

NOTE. When nontrivial, "φ_xtern/CODE_HASH" should contain the following (split into hi/lo parts)

        code ≡ 0xef0001 ∙ address
        KECCAK( code )

where ∙ stands for byte concatenation, and the 'code' is thus always a 23 byte string.

NOTE. Between any rows that are "nontrivial" there will be several (at least 13, but potentially unboundedly many) "trivial rows"

| φ_SEL |   |   |   |   |   |   |   |
|-------+---+---+---+---+---+---+---|
| 1     | X | X | X | X | X | X | X | ← "nontrivial row"
| 0     | 0 | 0 | 0 | 0 | 0 | 0 | 0 | ← "trivial row"
| ⋮     | ⋮ | ⋮ | ⋮ | ⋮ | ⋮ | ⋮ | ⋮ |
| 0     | 0 | 0 | 0 | 0 | 0 | 0 | 0 |
| 1     | Y | Y | Y | Y | Y | Y | Y | ← other "nontrivial row"

NOTE. There are at least 13 + 1 + 1 + (1 + 1 + 3 + 3 + 3) between any two "nontrivial rows"

NOTE. The prefix can be added by the prover circuit.

|-----------------+-------------+----------------------------+-----------+-------+---------+-----------|
| USER_TXN_NUMBER | TUPLE_INDEX | limbs                      | limb_size | index | IS_DATA | IS_RESULT |
|-----------------+-------------+----------------------------+-----------+-------+:-------:+:---------:|
| n               | a           | <left_aligned_prefix>      | 3         | 0     |  <true> |
| n               | a           | <left_aligned_address_hi>  | 4         | 1     |  <true> |
| n               | a           | <left_aligned_address_lo>  | 16        | 2     |  <true> |
|-----------------+-------------+----------------------------+-----------+-------+---------+-----------|
| n               | a           | <keccak_hi>                |           | 0     |         |   <true>  |
| n               | a           | <keccak_lo>                |           | 1     |         |   <true>  |
|-----------------+-------------+----------------------------+-----------+-------+---------+-----------|
| ∅               |             |                            |           |       |         |           |
| ⋮               |             |                            |           |       |         |           |
| ∅               |             |                            |           |       |         |           |
|-----------------+-------------+----------------------------+-----------+-------+---------+-----------|
| n               | b           | <left_aligned_prefix>'     | 3         | 0     |  <true> |
| n               | b           | <left_aligned_address_hi>' | 4         | 1     |  <true> |
| n               | b           | <left_aligned_address_lo>' | 16        | 2     |  <true> |
|-----------------+-------------+----------------------------+-----------+-------+---------+-----------|
| n               | b           | <keccak_hi>'               |           | 0     |         |   <true>  |
| n               | b           | <keccak_lo>'               |           | 1     |         |   <true>  |
|-----------------+-------------+----------------------------+-----------+-------+---------+-----------|

NOTE. Results on a line would also be ok.

\end{verbatim}
\end{document}
