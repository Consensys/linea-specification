# Shomei triggers

| scenario | instruction  | subscenario  | account           | storage               | SHOMEI_TRIGGER        | Notes                                       |
|----------|--------------|--------------|:------------------|:----------------------|:----------------------|---------------------------------------------|
| TX_SKIP  |              |              | sender            |                       | ✓                     |                                             |
|          |              |              | recipient         |                       | ✓                     | regardless of tx.value == 0 or not          |
|          |              |              | coinbase          |                       | ✓                     |                                             |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|---------------------------------------------|
| TX_WARM  |              |              | acc. list address |                       | ✗                     |
|          |              |              |                   | acc. list storage key | ✗                     |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|
| TX_INIT  |              |              | sender            |                       | ✓                     |
|          |              |              | recipient         |                       | ✓                     |
|          |              |              | (coinbase)        |                       | not today             |
|          |              |              |                   |                       | pre-warmed for Prague |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|
| TX_FINL  |              |              | sender            |                       | ✓ (trash)             |
|          |              |              | coinbase          |                       | ✓ (trash in Prague)   |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|
| TX_EXEC  | any          | SUX/SOX      | ∅                 |                       |                       |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|---------------------------------------------|
|          | SELFBALANCE  | OOGX         | ∅                 |                       | ∅                     | irrelevant: the underlying                  |
|          |              | XAHOY ≡ 0    | ✓                 |                       | ✓ (trash)             | account has already been loaded             |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|---------------------------------------------|
|          | BALANCE      | OOGX         | ✓                 |                       | ✗                     | only the warmth matters to price this       |
|          | EXTCODESIZE  |              |                   |                       |                       | opcode                                      |
|          | EXTCODEHASH  |              |                   |                       |                       |                                             |
|          |              |              |                   |                       |                       | question: what happens if the account       |
|          |              |              |                   |                       |                       | does not exist in the state ?               |
|          |              |              |                   |                       |                       |                                             |
|          |              | XAHOY ≡ 0    | ✓                 |                       | ✓                     | requires target account                     |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|---------------------------------------------|
|          | EXTCODECOPY  | MXPX         | ∅                 |                       | ∅                     | if MXPX ≡ true then the arithmetization     |
|          |              |              |                   |                       |                       | doesn't require the account to be loaded    |
|          |              |              |                   |                       |                       |                                             |
|          |              | OOGX         | ✓                 |                       | ✗                     | if OOGX ≡ true the arithmetization does     |
|          |              |              |                   |                       |                       | require the account row (for WARMTH) but    |
|          |              |              |                   |                       |                       | Shomei has no reason to load the account    |
|          |              |              |                   |                       |                       |                                             |
|          |              | XAHOY ≡ 0    | ✓                 |                       | ✓                     | requires target account                     |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|---------------------------------------------|
|          | CODESIZE     | JUMPX        |                   |                       | ✓ (trash)             | The underlying account must have already    |
|          | CODECOPY     | OOGX         |                   |                       | ✓ (trash)             | been loaded by Besu/Shomei                  |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|---------------------------------------------|
|          | JUMP         | OOGX         | ∅                 |                       | ∅                     |                                             |
|          | JUMPI        |              |                   |                       |                       |                                             |
|          |              | JUMPX        | ✓                 |                       | ✓ (trash)             |                                             |
|          |              |              |                   |                       |                       |                                             |
|          |              |              |                   |                       |                       |                                             |
|          |              | XAHOY ≡ 0    | ✓                 |                       | ✓ (trash)             |                                             |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|---------------------------------------------|
|          | CALL         | STATICX      | ∅                 |                       | ∅                     | ∅                                           |
|          | CALLCODE     | (CALL only)  |                   |                       |                       |                                             |
|          | DELEGATECALL |              |                   |                       |                       |                                             |
|          | STATICCALL   | MXPX         | ∅                 |                       | ✓                     | this is an issue ... we may have to add     |
|          |              |              |                   |                       |                       | an account-row to handle this case well.    |
|          |              |              |                   |                       |                       |                                             |
|          |              |              |                   |                       |                       |                                             |
|          |              | OOGX         | ✓                 |                       | ✓                     | requires the target account                 |
|          |              |              |                   |                       |                       | this is true even for CALL-type opcodes     |
|          |              |              |                   |                       |                       | that don't transfer value and therefore     |
|          |              |              |                   |                       |                       | don't care about target account existence   |
|          |              |              |                   |                       |                       | ... thank God !                             |
|          |              |              |                   |                       |                       |                                             |
|          |              | abortCSD     | ✓                 |                       | ✓                     | same                                        |
|          |              |              |                   |                       |                       |                                             |
|          |              | abortBAL     | ✓                 |                       | ✓                     | same                                        |
|          |              |              |                   |                       |                       |                                             |
|          |              | XAHOY ≡ 0    | ✓                 |                       | ✓                     | same                                        |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|---------------------------------------------|
|          | CREATE       | STATICX      |                   |                       |                       | ∅                                           |
|          | CREATE2      |              |                   |                       |                       |                                             |
|          |              | (MAXCSX)     |                   |                       |                       | (Pectra)                                    |
|          |              |              |                   |                       |                       |                                             |
|          |              | MXPX         |                   |                       |                       | ∅                                           |
|          |              |              |                   |                       |                       |                                             |
|          |              | OOGX         |                   |                       |                       | requires the target account                 |
|          |              |              |                   |                       |                       |                                             |
|          |              | abortCSD     |                   |                       |                       | same                                        |
|          |              |              |                   |                       |                       |                                             |
|          |              | abortBAL     |                   |                       |                       | same                                        |
|          |              |              |                   |                       |                       |                                             |
|          |              | fail_cond_F  |                   |                       |                       | same                                        |
|          |              |              |                   |                       |                       |                                             |
|          |              | XAHOY ≡ 0    |                   |                       |                       | same                                        |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|---------------------------------------------|
|          | SELFDESTRUCT | STATICX      | ∅                 |                       |                       | ∅                                           |
|          |              |              |                   |                       |                       |                                             |
|          |              | OOGX         | ✓                 |                       | ✓                     | requires the "heir" account                 |
|          |              |              |                   |                       |                       | even if zero balance transfer               |
|          |              |              |                   |                       |                       |                                             |
|          |              | XAHOY ≡ 0    | ✓                 |                       | ✓                     | same                                        |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|---------------------------------------------|
|          | STOP         |              |                   |                       |                       | If deployment then leads to an (empty)      |
|          |              |              |                   |                       |                       | deployment. The account must already        |
|          |              | XAHOY ≡ 0    | ✓ (if dep)        |                       | ✓ (trash)             | have been loaded.                           |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|---------------------------------------------|
|          | REVERT       | MXPX         | ∅                 |                       | ∅                     |                                             |
|          |              |              |                   |                       |                       |                                             |
|          |              | OOGX         | ∅                 |                       | ∅                     |                                             |
|          |              |              |                   |                       |                       |                                             |
|          |              | XAHOY ≡ 0    | ∅                 |                       | ∅                     |                                             |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|---------------------------------------------|
|          | RETURN       | MAXCSX       | ∅                 |                       | ∅                     |                                             |
|          |              |              |                   |                       |                       |                                             |
|          |              | MXPX         | ∅                 |                       | ∅                     |                                             |
|          |              |              |                   |                       |                       |                                             |
|          |              | OOGX         | ∅                 |                       | ∅                     |                                             |
|          |              |              |                   |                       |                       |                                             |
|          |              | ICPX         | ∅                 |                       | ∅                     |                                             |
|          |              |              |                   |                       |                       |                                             |
|          |              | XAHOY ≡ 0    | ∅                 |                       | ∅                     |                                             |
|          |              | (mess. call) |                   |                       |                       |                                             |
|          |              |              |                   |                       |                       |                                             |
|          |              | XAHOY ≡ 0    | ✓                 |                       | ✓ (trash)             | Deployment                                  |
|          |              | (deployment) |                   |                       |                       |                                             |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|---------------------------------------------|
|          | SLOAD        | OOGX         | ✓                 | ✓                     | ✗                     |                                             |
|          |              |              |                   |                       |                       |                                             |
|          |              | XAHOY ≡ 0    | ✓                 | ✓                     | ✓                     | same                                        |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|---------------------------------------------|
|          | SSTORE       | STATICX      | ∅                 | ∅                     | ∅                     | ∅                                           |
|          |              |              |                   |                       |                       |                                             |
|          |              | SSTOREX      | ∅                 | ∅                     | ∅                     | ⇐ since @François' PR                       |
|          |              |              |                   |                       |                       |                                             |
|          |              | OOGX         | ✓                 | ✓                     | ✓                     | requires (current) account and storage slot |
|          |              |              |                   |                       |                       |                                             |
|          |              | XAHOY ≡ 0    | ✓                 | ✓                     | ✓                     | same                                        |
|----------|--------------|--------------|-------------------|-----------------------|-----------------------|---------------------------------------------|
