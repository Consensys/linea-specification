% !TeX TS-program = lualatex
\documentclass[varwidth=\maxdimen,margin=0.5cm,multi={verbatim}]{standalone}

\usepackage{../../../../../../pkg/draculatheme}

\usepackage{fontspec}
\directlua{luaotfload.add_fallback
   ("emojifallback",
    {
      "NotoColorEmoji:mode=harf;"
    }
   )}

\setmonofont{JetBrains Mono NL Regular}[
  RawFeature={fallback=emojifallback}
]

\begin{document}
\begin{verbatim}


 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\  â–ˆâ–ˆ\                           â–ˆâ–ˆ\                 â–ˆâ–ˆ\
â–ˆâ–ˆ  __â–ˆâ–ˆ\ \__|                          â–ˆâ–ˆ |                \__|
â–ˆâ–ˆ /  \__|â–ˆâ–ˆ\ â–ˆâ–ˆ\   â–ˆâ–ˆ\  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ |       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\ â–ˆâ–ˆ\ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\
â–ˆâ–ˆâ–ˆâ–ˆ\     â–ˆâ–ˆ |\â–ˆâ–ˆ\ â–ˆâ–ˆ  |â–ˆâ–ˆ  __â–ˆâ–ˆ\ â–ˆâ–ˆ  __â–ˆâ–ˆ |      â–ˆâ–ˆ  _____|â–ˆâ–ˆ |\____â–ˆâ–ˆ  |â–ˆâ–ˆ  __â–ˆâ–ˆ\
â–ˆâ–ˆ  _|    â–ˆâ–ˆ | \â–ˆâ–ˆâ–ˆâ–ˆ  / â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ |â–ˆâ–ˆ /  â–ˆâ–ˆ |      \â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\  â–ˆâ–ˆ |  â–ˆâ–ˆâ–ˆâ–ˆ _/ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ |
â–ˆâ–ˆ |      â–ˆâ–ˆ | â–ˆâ–ˆ  â–ˆâ–ˆ<  â–ˆâ–ˆ   ____|â–ˆâ–ˆ |  â–ˆâ–ˆ |       \____â–ˆâ–ˆ\ â–ˆâ–ˆ | â–ˆâ–ˆ  _/   â–ˆâ–ˆ   ____|
â–ˆâ–ˆ |      â–ˆâ–ˆ |â–ˆâ–ˆ  /\â–ˆâ–ˆ\ \â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\ \â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ |      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  |â–ˆâ–ˆ |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\ \â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\
\__|      \__|\__/  \__| \_______| \_______|      \_______/ \__|\________| \_______|


                                â–ˆâ–ˆ\            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\                                                                                                                                    â–ˆâ–ˆ\ â–ˆâ–ˆ\                     
                                â–ˆâ–ˆ |          â–ˆâ–ˆ  __â–ˆâ–ˆ\                                                                                                                                   \__|â–ˆâ–ˆ |                    
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\         â–ˆâ–ˆ /  \__| â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\ â–ˆâ–ˆ\   â–ˆâ–ˆ\ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\â–ˆâ–ˆâ–ˆâ–ˆ\   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\  â–ˆâ–ˆ\ â–ˆâ–ˆ | â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\ 
â–ˆâ–ˆ  __â–ˆâ–ˆ\ â–ˆâ–ˆ  __â–ˆâ–ˆ\ â–ˆâ–ˆ  _____|\_â–ˆâ–ˆ  _|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\ â–ˆâ–ˆ |       \____â–ˆâ–ˆ\ â–ˆâ–ˆ  __â–ˆâ–ˆ\ â–ˆâ–ˆ  _____|â–ˆâ–ˆ |  â–ˆâ–ˆ |â–ˆâ–ˆ  __â–ˆâ–ˆ\       â–ˆâ–ˆ  __â–ˆâ–ˆ\ â–ˆâ–ˆ  __â–ˆâ–ˆ\ â–ˆâ–ˆ  __â–ˆâ–ˆ\ â–ˆâ–ˆ  _____|â–ˆâ–ˆ  __â–ˆâ–ˆ\ â–ˆâ–ˆ  _â–ˆâ–ˆ  _â–ˆâ–ˆ\ â–ˆâ–ˆ  __â–ˆâ–ˆ\ â–ˆâ–ˆ |â–ˆâ–ˆ |â–ˆâ–ˆ  __â–ˆâ–ˆ\ â–ˆâ–ˆ  _____|
â–ˆâ–ˆ /  â–ˆâ–ˆ |â–ˆâ–ˆ /  â–ˆâ–ˆ |\â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\    â–ˆâ–ˆ |  \______|â–ˆâ–ˆ |       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ |â–ˆâ–ˆ |  â–ˆâ–ˆ |â–ˆâ–ˆ /      â–ˆâ–ˆ |  â–ˆâ–ˆ |â–ˆâ–ˆ |  â–ˆâ–ˆ |      â–ˆâ–ˆ /  â–ˆâ–ˆ |â–ˆâ–ˆ |  \__|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ |â–ˆâ–ˆ /      â–ˆâ–ˆ /  â–ˆâ–ˆ |â–ˆâ–ˆ / â–ˆâ–ˆ / â–ˆâ–ˆ |â–ˆâ–ˆ /  â–ˆâ–ˆ |â–ˆâ–ˆ |â–ˆâ–ˆ |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ |\â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\  
â–ˆâ–ˆ |  â–ˆâ–ˆ |â–ˆâ–ˆ |  â–ˆâ–ˆ | \____â–ˆâ–ˆ\   â–ˆâ–ˆ |â–ˆâ–ˆ\       â–ˆâ–ˆ |  â–ˆâ–ˆ\ â–ˆâ–ˆ  __â–ˆâ–ˆ |â–ˆâ–ˆ |  â–ˆâ–ˆ |â–ˆâ–ˆ |      â–ˆâ–ˆ |  â–ˆâ–ˆ |â–ˆâ–ˆ |  â–ˆâ–ˆ |      â–ˆâ–ˆ |  â–ˆâ–ˆ |â–ˆâ–ˆ |      â–ˆâ–ˆ   ____|â–ˆâ–ˆ |      â–ˆâ–ˆ |  â–ˆâ–ˆ |â–ˆâ–ˆ | â–ˆâ–ˆ | â–ˆâ–ˆ |â–ˆâ–ˆ |  â–ˆâ–ˆ |â–ˆâ–ˆ |â–ˆâ–ˆ |â–ˆâ–ˆ   ____| \____â–ˆâ–ˆ\ 
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  |\â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  |  \â–ˆâ–ˆâ–ˆâ–ˆ  |      \â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  |\â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ |â–ˆâ–ˆ |  â–ˆâ–ˆ |\â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\ \â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  |â–ˆâ–ˆ |  â–ˆâ–ˆ |      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  |â–ˆâ–ˆ |      \â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\ \â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\ \â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  |â–ˆâ–ˆ | â–ˆâ–ˆ | â–ˆâ–ˆ |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  |â–ˆâ–ˆ |â–ˆâ–ˆ |\â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  |
â–ˆâ–ˆ  ____/  \______/ \_______/    \____/        \______/  \_______|\__|  \__| \_______| \______/ \__|  \__|      â–ˆâ–ˆ  ____/ \__|       \_______| \_______| \______/ \__| \__| \__|â–ˆâ–ˆ  ____/ \__|\__| \_______|\_______/ 
â–ˆâ–ˆ |                                                                                                            â–ˆâ–ˆ |                                                            â–ˆâ–ˆ |                                  
â–ˆâ–ˆ |                                                                                                            â–ˆâ–ˆ |                                                            â–ˆâ–ˆ |                                  
\__|                                                                                                            \__|                                                            \__|


          __|   _ \   __ `__ \   __ `__ \    _ \   __ \
         (     (   |  |   |   |  |   |   |  (   |  |   |
        \___| \___/  _|  _|  _| _|  _|  _| \___/  _|  _|


|-------+--------+------------------------------+------------------------------------------------------------|
| Row   | Persp. |                              |                                                            |
|-------+--------+------------------------------+------------------------------------------------------------|
| i     | SCEN   | one of:                      | SCEN/PRC_FKTH + SCEN/PRC_FKTR + SCEN/PRC_SUCCESS = 1       |
|       |        |                              |                                                            |
|       |        | starting with Cancun:        |                                                            |
|       |        | * SCEN/POINT_EVALUATION = 1  |                                                            |
|       |        |                              |                                                            |
|       |        | starting with Prague:        |                                                            |
|       |        | * SCEN/BLS_G1ADD         = 1 |                                                            |
|       |        | * SCEN/BLS_G2ADD         = 1 |                                                            |
|       |        | * SCEN/BLS_MAP_FP_TO_G1  = 1 |                                                            |
|       |        | * SCEN/BLS_MAP_FP2_TO_G2 = 1 |                                                            |
|       |        |                              |                                                            |
|       |        | starting with Osaka:         |                                                            |
|       |        | * SCEN/PRC_P256_VERIFY   = 1 |                                                            |
|-------+--------+------------------------------+------------------------------------------------------------|
| i + 1 | MISC   |                              | OOBðŸš© = 1                                                  |
|       |        |                              | OOB_INST (case dependent)                                  |
|       |        |                              | * âŸ¦OOB_INST_point_evaluationâŸ§                              |
|       |        |                              | * âŸ¦OOB_INST_bls_g1addâŸ§                                     |
|       |        |                              | * âŸ¦OOB_INST_bls_g2addâŸ§                                     |
|       |        |                              | * âŸ¦OOB_INST_bls_map_fp_to_g1âŸ§                              |
|       |        |                              | * âŸ¦OOB_INST_bls_map_fp2_to_g2âŸ§                             |
|       |        |                              | * âŸ¦OOB_INST_p256_verifyâŸ§                                   |
|       |        |                              |                                                            |
|       |        |                              | TRUSTED INPUTS:                                            |
|       |        |                              | * cds                                                      |
|       |        |                              | * r@c                                                      |
|       |        |                              | * call_gas                                                 |
|       |        |                              |                                                            |
|       |        |                              | JUSTIFICATION FOR:                                         |
|       |        |                              | * (implicit) compute gas_cost                              |
|       |        |                              | * hub_success        â‰¡  [gas_cost â‰¤ call_gas]              |
|       |        |                              | .                       âˆ§ [call data size = imposed_cds]   |
|       |        |                              | * return_gas         â‰¡  hub_success ? [call_gas - gas_cost]|
|       |        |                              | .                                   : 0                    |
|       |        |                              | * extract_call_data  â‰¡  hub_success âˆ§ [cds â‰  0]            |
|       |        |                              | .                    â‰¡  hub_success                        |
|       |        |                              | * empty_call_data    â‰¡  hub_success âˆ§ [cds = 0]            |
|       |        |                              | .                    â‰¡  FALSE                              |
|       |        |                              | * r@c_nonzero        â‰¡  [r@c â‰  0]                          |
|       |        |                              |                                                            |
|       |        | MMUðŸš© = hub_success          |                                                            |
|       |        | MMU_INST = <RETURN_like>     |                                                            |
|       |        |                              |                                                            |
|       |        | ID_SCR  := CN                |                                                            |
|       |        | SRC_OFF := CDO               |                                                            |
|       |        | SIZE    := CDS               |                                                            |
|       |        |                              |                                                            |
|       |        | ID_TGT  := 1 + HUB_STAMP     |                                                            |
|       |        | TGT_OFF := 0                 |                                                            |
|       |        |                              |                                                            |
|       |        | ram_success := 0 / 1         |                                                            |
|       |        |               (prediction)   |                                                            |
|-------+--------+------------------------------+------------------------------------------------------------|
| ...   | ...    | ...                          | ...                                                        |

We have used the following abbreviations:
  FKTH â‰¡ FAILURE_KNONWN_TO_HUB
  FKTR â‰¡ FAILURE_KNONWN_TO_RAM

NOTE. depending on the case we use the notation " âˆ¨ " either as logical OR or as the maximum;
similarly we use the notation " âˆ§ " as either logical AND or as the minimum. We further use
(standard) ternary operator notation

      condition ? val_T
                : val_F

NOTE. The BLS precompiles and P256_Verify added with

+ EIP-4844:
    - POINT_EVALUATION
+ EIP-2537:
    - G1ADD          - G2ADD      
    - MAP_FP_TO_G1   - MAP_FP_TO_G2
+ EIP-7951:
    - P256_VERIFY
all have the nice-to-have property that providing them with empty call data, and more generally: call data that isn't the right
(prescribed) size in bytes or a (nonzero) multiple of some reference size, results in a failure (FAILURE_KNOWN_TO_HUB in the
way we arithmetize things) of the precompile, and thus the precompile burning all provided gas, clearing out its caller's
return data, and outputting ZERO onto the caller's stack.

NOTE. For BLS and P256_Verify operations we have special relations:

* extract_call_data â‰¡ hub_success
* empty_call_data   â‰¡ FALSE

\end{verbatim}
\end{document}

