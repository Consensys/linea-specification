% !TeX TS-program = lualatex
\documentclass[varwidth=\maxdimen,margin=0.5cm,multi={verbatim}]{standalone}

\usepackage{fontspec}
\directlua{luaotfload.add_fallback
   ("emojifallback",
    {
      "NotoColorEmoji:mode=harf;"
    }
   )}

\usepackage{../../../../../../pkg/draculatheme}

\setmonofont{JetBrains Mono NL Regular}[
  RawFeature={fallback=emojifallback}
]

\begin{document}
\begin{verbatim}

               ‚ñà‚ñà\      ‚ñà‚ñà\  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\ ‚ñà‚ñà\   ‚ñà‚ñà\ ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\                                                                            
               ‚ñà‚ñà‚ñà\    ‚ñà‚ñà‚ñà |‚ñà‚ñà  __‚ñà‚ñà\ ‚ñà‚ñà  __‚ñà‚ñà\ ‚ñà‚ñà  _____|‚ñà‚ñà |  ‚ñà‚ñà |‚ñà‚ñà  __‚ñà‚ñà\                                                                           
               ‚ñà‚ñà‚ñà‚ñà\  ‚ñà‚ñà‚ñà‚ñà |‚ñà‚ñà /  ‚ñà‚ñà |‚ñà‚ñà |  ‚ñà‚ñà |‚ñà‚ñà |      \‚ñà‚ñà\ ‚ñà‚ñà  |‚ñà‚ñà |  ‚ñà‚ñà |       ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\‚ñà‚ñà‚ñà‚ñà\  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\‚ñà‚ñà‚ñà‚ñà\   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\  ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\  
               ‚ñà‚ñà\‚ñà‚ñà\‚ñà‚ñà ‚ñà‚ñà |‚ñà‚ñà |  ‚ñà‚ñà |‚ñà‚ñà |  ‚ñà‚ñà |‚ñà‚ñà‚ñà‚ñà‚ñà\     \‚ñà‚ñà‚ñà‚ñà  / ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  |      ‚ñà‚ñà  _____|‚ñà‚ñà  __‚ñà‚ñà\ ‚ñà‚ñà  _‚ñà‚ñà  _‚ñà‚ñà\ ‚ñà‚ñà  _‚ñà‚ñà  _‚ñà‚ñà\ ‚ñà‚ñà  __‚ñà‚ñà\ ‚ñà‚ñà  __‚ñà‚ñà\ 
               ‚ñà‚ñà \‚ñà‚ñà‚ñà  ‚ñà‚ñà |‚ñà‚ñà |  ‚ñà‚ñà |‚ñà‚ñà |  ‚ñà‚ñà |‚ñà‚ñà  __|    ‚ñà‚ñà  ‚ñà‚ñà<  ‚ñà‚ñà  ____/       ‚ñà‚ñà /      ‚ñà‚ñà /  ‚ñà‚ñà |‚ñà‚ñà / ‚ñà‚ñà / ‚ñà‚ñà |‚ñà‚ñà / ‚ñà‚ñà / ‚ñà‚ñà |‚ñà‚ñà /  ‚ñà‚ñà |‚ñà‚ñà |  ‚ñà‚ñà |
               ‚ñà‚ñà |\‚ñà  /‚ñà‚ñà |‚ñà‚ñà |  ‚ñà‚ñà |‚ñà‚ñà |  ‚ñà‚ñà |‚ñà‚ñà |      ‚ñà‚ñà  /\‚ñà‚ñà\ ‚ñà‚ñà |            ‚ñà‚ñà |      ‚ñà‚ñà |  ‚ñà‚ñà |‚ñà‚ñà | ‚ñà‚ñà | ‚ñà‚ñà |‚ñà‚ñà | ‚ñà‚ñà | ‚ñà‚ñà |‚ñà‚ñà |  ‚ñà‚ñà |‚ñà‚ñà |  ‚ñà‚ñà |
               ‚ñà‚ñà | \_/ ‚ñà‚ñà | ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\ ‚ñà‚ñà /  ‚ñà‚ñà |‚ñà‚ñà |            \‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà\ \‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  |‚ñà‚ñà | ‚ñà‚ñà | ‚ñà‚ñà |‚ñà‚ñà | ‚ñà‚ñà | ‚ñà‚ñà |\‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  |‚ñà‚ñà |  ‚ñà‚ñà |
               \__|     \__| \______/ \_______/ \________|\__|  \__|\__|             \_______| \______/ \__| \__| \__|\__| \__| \__| \______/ \__|  \__|




|-------+--------+-------------------------------------------------+------------------------------------------+-----------------------------------------------------------|
| Row   | Persp. |                                                 |                                          |                                                           |
|-------+--------+-------------------------------------------------+------------------------------------------+-----------------------------------------------------------|
| i     | SCEN   | here:                                           |                                          |                                                           |
|       |        | * SCEN/MODEXP                                   |                                          |                                                           |
|-------+--------+-------------------------------------------------+------------------------------------------+-----------------------------------------------------------|
| i + 1 | MISC   | MMUüè¥ = 0                                       | EXPüè¥ = 0                                | OOBüè¥ = 1                                                 |
|       |        |                                                 |                                          | OOB_INST = ‚ü¶OOB_INST_modexp_cds‚üß                          |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | TRUSTED INPUTS:                                           |
|       |        |                                                 |                                          | * cds                                                     |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | JUSTIFICATION FOR:                                        |
|       |        |                                                 |                                          | * extract_bbs ‚â° [cds >  0]                                |
|       |        |                                                 |                                          | * extract_ebs ‚â° [cds > 32]                                |
|       |        |                                                 |                                          | * extract_mbs ‚â° [cds > 64]                                |
|-------+--------+-------------------------------------------------+------------------------------------------+-----------------------------------------------------------|
| i + 2 | MISC   | MMUüè¥    = extract_bbs                          | EXPüè¥ = 0                                |                                                           |
|       |        | MMU_INST = ‚ü¶MMU_INST_rightPaddedWordExtraction‚üß |                                          |                                                           |
|       |        |                                                 |                                          |                                                           |
|       |        | TRUSTED INPUTS:                                 |                                          |                                                           |
|       |        | * SRC_ID         = cn                           |                                          |                                                           |
|       |        | * SRC_OFFSET_LO  = 0                            |                                          |                                                           |
|       |        | * REF_OFFSET     = cdo                          |                                          |                                                           |
|       |        | * REF_SIZE       = cds                          |                                          |                                                           |
|       |        |                                                 |                                          |                                                           |
|       |        | JUSTIFICATION FOR:                              |                                          |                                                           |
|       |        | * bbs_hi                                        |                                          |                                                           |
|       |        | * bbs_lo                                        |                                          |                                                           |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | OOBüè¥ = 1                                                 |
|       |        |                                                 |                                          | OOB_INST = ‚ü¶OOB_INST_modexp_xbs‚üß                          |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | TRUSTED INPUTS:                                           |
|       |        |                                                 |                                          | * bbs_hi                                                  |
|       |        |                                                 |                                          | * bbs_lo                                                  |
|       |        |                                                 |                                          | * 0                                                       |
|       |        |                                                 |                                          | * do_compute_max = 0                                      |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | JUSTIFICATION FOR:                                        |
|       |        |                                                 |                                          | * bbs_within_bounds  ‚áî  [bbs ‚â§ 1024]                      |
|       |        |                                                 |                                          | * bbs_out_of_bounds  ‚áî  [bbs > 1024]                      |
|-------+--------+-------------------------------------------------+------------------------------------------+-----------------------------------------------------------|
| i + 3 | MISC   | MMUüè¥ = extract_ebs                             | EXPüè¥ = 0                                |                                                           |
|       |        | MMU_INST = ‚ü¶MMU_INST_rightPaddedWordExtraction‚üß |                                          |                                                           |
|       |        |                                                 |                                          |                                                           |
|       |        | TRUSTED INPUTS:                                 |                                          |                                                           |
|       |        | * SRC_ID         = cn                           |                                          |                                                           |
|       |        | * SRC_OFFSET_LO  = 32                           |                                          |                                                           |
|       |        | * REF_OFFSET     = cdo                          |                                          |                                                           |
|       |        | * REF_SIZE       = cds                          |                                          |                                                           |
|       |        |                                                 |                                          |                                                           |
|       |        | JUSTIFICATION FOR:                              |                                          |                                                           |
|       |        | * ebs_hi                                        |                                          |                                                           |
|       |        | * ebs_lo                                        |                                          |                                                           |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | OOBüè¥ = 1                                                 |
|       |        |                                                 |                                          | OOB_INST = ‚ü¶OOB_INST_modexp_xbs‚üß                          |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | TRUSTED INPUTS:                                           |
|       |        |                                                 |                                          | * ebs_hi                                                  |
|       |        |                                                 |                                          | * ebs_lo                                                  |
|       |        |                                                 |                                          | * 0                                                       |
|       |        |                                                 |                                          | * do_compute_max ‚â° 0                                      |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | JUSTIFICATION FOR:                                        |
|       |        |                                                 |                                          | * ebs_is_within_bounds  ‚áî  [ebs ‚â§ 1024]                   |
|       |        |                                                 |                                          | * ebs_is_out_of_bounds  ‚áî  [ebs > 1024]                   |
|-------+--------+-------------------------------------------------+------------------------------------------+-----------------------------------------------------------|
| i + 4 | MISC   | MMUüè¥    = extract_mbs                          | EXPüè¥ = 0                                |                                                           |
|       |        | MMU_INST ‚â° ‚ü¶MMU_INST_rightPaddedWordExtraction‚üß |                                          |                                                           |
|       |        |                                                 |                                          |                                                           |
|       |        | TRUSTED INPUTS:                                 |                                          |                                                           |
|       |        | * SRC_ID         = cn                           |                                          |                                                           |
|       |        | * SRC_OFFSET_LO  = 64                           |                                          |                                                           |
|       |        | * REF_OFFSET     = cdo                          |                                          |                                                           |
|       |        | * REF_SIZE       = cds                          |                                          |                                                           |
|       |        |                                                 |                                          |                                                           |
|       |        | JUSTIFICATION FOR:                              |                                          |                                                           |
|       |        | * ebs_hi                                        |                                          |                                                           |
|       |        | * ebs_lo                                        |                                          |                                                           |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | OOBüè¥ = 1                                                 |
|       |        |                                                 |                                          | OOB_INST = ‚ü¶OOB_INST_modexp_xbs‚üß                          |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | TRUSTED INPUTS:                                           |
|       |        |                                                 |                                          | * mbs_hi                                                  |
|       |        |                                                 |                                          | * mbs_lo                                                  |
|       |        |                                                 |                                          | * bbs_lo                                                  |
|       |        |                                                 |                                          | * do_compute_max ‚â° 1                                      |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | JUSTIFICATION FOR:                                        |
|       |        |                                                 |                                          | * max_bbs_mbs ‚â° bbs ‚à® mbs                                 |
|       |        |                                                 |                                          | * mbs_nonzero ‚â° [mbs ‚â† 0]                                 |
|       |        |                                                 |                                          | * mbs_is_within_bounds  ‚áî  [mbs ‚â§ 1024]                   |
|       |        |                                                 |                                          | * mbs_is_out_of_bounds  ‚áî  [mbs > 1024]                   |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | DEFINE:                                                   |
|       |        |                                                 |                                          | * all_byte_sizes_are_in_bounds ‚â°  bbs_is_within_bounds    |
|       |        |                                                 |                                          | .                                 ‚àß  ebs_is_within_bounds |
|       |        |                                                 |                                          | .                                 ‚àß  mbs_is_within_bounds |
|-------+--------+-------------------------------------------------+------------------------------------------+-----------------------------------------------------------|
| i + 5 | MISC   |                                                 |                                          | OOBüè¥    = all_byte_sizes_are_in_bounds                   |
|       |        |                                                 |                                          | OOB_INST = ‚ü¶OOB_INST_modexp_lead‚üß                         |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | TRUSTED INPUTS:                                           |
|       |        |                                                 |                                          | * bbs_lo                                                  |
|       |        |                                                 |                                          | * cds                                                     |
|       |        |                                                 |                                          | * ebs_lo                                                  |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | JUSTIFICATION FOR:                                        |
|       |        |                                                 |                                          | * load_lead           ‚â° [cds > 96 + bbs] ‚àß [ebs ‚â† 0]      |
|       |        |                                                 |                                          | * lead_calldata_bytes ‚â° 32 ‚àß [0 ‚à® [cds - (96 + bbs)]]     |
|       |        |                                                 |                                          | * lead_exponent_bytes ‚â° 32 ‚àß ebs                          |
|       |        |                                                 |                                          | * ebs_sub_32          ‚â°  0 ‚à® [ebs - 32]                   |
|       |        |                                                 |                                          |                                                           |
|       |        | MMUüè¥    = OOBüè¥ ‚àß load_lead                    |                                          |                                                           |
|       |        | MMU_INST = MLOAD                                |                                          |                                                           |
|       |        |                                                 |                                          |                                                           |
|       |        | TRUSTED INPUTS:                                 |                                          |                                                           |
|       |        | * SRC_ID        = cn                            |                                          |                                                           |
|       |        | * SRC_OFFSET_LO = cdo + 96 + bbs                |                                          |                                                           |
|       |        |                                                 |                                          |                                                           |
|       |        | JUSTIFICATION FOR:                              |                                          |                                                           |
|       |        | * raw_leading_word_of_exponent_hi               |                                          |                                                           |
|       |        | * raw_leading_word_of_exponent_lo               |                                          |                                                           |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 | EXPüè¥    = OOBüè¥ ‚àß load_lead             |                                                           |
|       |        |                                                 | EXP_INST = ‚ü¶EXP_INST_modexpLog‚üß          |                                                           |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 | TRUSTED INPUTS:                          |                                                           |
|       |        |                                                 | * raw_leading_word_of_exponent_hi        |                                                           |
|       |        |                                                 | * raw_leading_word_of_exponent_lo        |                                                           |
|       |        |                                                 | * lead_exponent_bytes                    |                                                           |
|       |        |                                                 | * lead_calldata_bytes                    |                                                           |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 | JUSTIFICATION FOR:                       |                                                           |
|       |        |                                                 | * lead_log ‚â°                             |                                                           |
|       |        |                                                 | .    ‚åä log_2(leading_word_of_exponent) ‚åã |                                                           |
|       |        |                                                 |                                          |                                                           |
|-------+--------+-------------------------------------------------+------------------------------------------+-----------------------------------------------------------|
| i + 6 | MISC   | MMUüè¥ = 0                                       | EXPüè¥ = 0                                | OOBüè¥    = all_byte_sizes_are_in_bounds                   |
|       |        |                                                 |                                          | OOB_INST = ‚ü¶OOB_INST_modexp_pricing‚üß                      |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | TRUSTED INPUTS:                                           |
|       |        |                                                 |                                          | * call_gas                                                |
|       |        |                                                 |                                          | * r@c                                                     |
|       |        |                                                 |                                          | * lead_log                                                |
|       |        |                                                 |                                          | * max_bbs_mbs                                             |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | JUSTIFICATION FOR:                                        |
|       |        |                                                 |                                          | * ram_success                                             |
|       |        |                                                 |                                          | * return_gas                                              |
|       |        |                                                 |                                          | * r@c_nonzero ‚â° [r@c ‚â† 0]                                 |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | WE IMPOSE:                                                |
|       |        |                                                 |                                          | * SCEN/SUCCESS = OOBüè¥ ‚àß ram_success                      |
|       |        |                                                 |                                          |                                                           |
|       |        |                                                 |                                          | Thus                                                      |
|       |        |                                                 |                                          | * ram_success = 0         (‚õî ‚üµ FAILURE)                  |
|       |        |                                                 |                                          | * ram_success = 1         (‚úÖ ‚üµ SUCCESS)                  |
|-------+--------+-------------------------------------------------+------------------------------------------+-----------------------------------------------------------|
\end{verbatim}
\end{document}


