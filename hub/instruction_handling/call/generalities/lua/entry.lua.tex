% !TeX TS-program = lualatex
\documentclass[varwidth=\maxdimen,margin=0.5cm,multi={verbatim}]{standalone}

\usepackage{fontspec}
\directlua{luaotfload.add_fallback
   ("emojifallback",
    {
      "NotoColorEmoji:mode=harf;"
    }
   )}

\setmonofont{JetBrains Mono NL Regular}[
  RawFeature={fallback=emojifallback}
]

\usepackage{../../../../../pkg/draculatheme}

\begin{document}
\begin{verbatim}

        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\  â–ˆâ–ˆ\       â–ˆâ–ˆ\          â–ˆâ–ˆ\
       â–ˆâ–ˆ  __â–ˆâ–ˆ\ â–ˆâ–ˆ  __â–ˆâ–ˆ\ â–ˆâ–ˆ |      â–ˆâ–ˆ |         â–ˆâ–ˆ |
       â–ˆâ–ˆ /  \__|â–ˆâ–ˆ /  â–ˆâ–ˆ |â–ˆâ–ˆ |      â–ˆâ–ˆ |       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\   â–ˆâ–ˆ\   â–ˆâ–ˆ\  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\
       â–ˆâ–ˆ |      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ |â–ˆâ–ˆ |      â–ˆâ–ˆ |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\\_â–ˆâ–ˆ  _|  â–ˆâ–ˆ |  â–ˆâ–ˆ |â–ˆâ–ˆ  __â–ˆâ–ˆ\ â–ˆâ–ˆ  __â–ˆâ–ˆ\
       â–ˆâ–ˆ |      â–ˆâ–ˆ  __â–ˆâ–ˆ |â–ˆâ–ˆ |      â–ˆâ–ˆ |\______| â–ˆâ–ˆ |    â–ˆâ–ˆ |  â–ˆâ–ˆ |â–ˆâ–ˆ /  â–ˆâ–ˆ |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ |
       â–ˆâ–ˆ |  â–ˆâ–ˆ\ â–ˆâ–ˆ |  â–ˆâ–ˆ |â–ˆâ–ˆ |      â–ˆâ–ˆ |         â–ˆâ–ˆ |â–ˆâ–ˆ\ â–ˆâ–ˆ |  â–ˆâ–ˆ |â–ˆâ–ˆ |  â–ˆâ–ˆ |â–ˆâ–ˆ   ____|
       \â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  |â–ˆâ–ˆ |  â–ˆâ–ˆ |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\    \â–ˆâ–ˆâ–ˆâ–ˆ  |\â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  |\â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\
        \______/ \__|  \__|\________|\________|    \____/  \____â–ˆâ–ˆ |â–ˆâ–ˆ  ____/  \_______|
                                                          â–ˆâ–ˆ\   â–ˆâ–ˆ |â–ˆâ–ˆ |
                                                          \â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  |â–ˆâ–ˆ |
                                                           \______/ \__|


                                                      |   _)                       |
        |   |  __ \    _ \ \ \  /   __|   _ \  __ \   __|  |   _ \   __ \    _` |  |
        |   |  |   |   __/  `  <   (      __/  |   |  |    |  (   |  |   |  (   |  |
       \__,_| _|  _| \___|  _/\_\ \___| \___|  .__/  \__| _| \___/  _|  _| \__,_| _|  )
                                              _|                                     /

                             |                   |              |
        |   |  __ \    _` |  __ \    _ \    __|  __|   _ \   _` |
        |   |  |   |  (   |  |   |  (   |  |     |     __/  (   |
       \__,_| _|  _| \__,_| _.__/  \___/  _|    \__| \___| \__,_|


|-----------+--------+---------------------------------------------------------------------+---------------------------------+-----------------------------------+-----------------------------------------------------+-----------+-----------|
| Row index | Persp. | Actions                                                             |                                 |                                   | Notes                                               | DOM_STAMP | SUB_STAMP |
|:---------:+--------+---------------------------------------------------------------------+---------------------------------+-----------------------------------+-----------------------------------------------------+-----------+-----------|
|   i - 2   | STACK  |                                                                     |                                 |                                   | required:                                           |
|   i - 1   | STACK  |                                                                     |                                 |                                   | * stack/STATICX â‰¡ 0                                 |
|     Â      |        |                                                                     |                                 |                                   | * stack/MXPX    â‰¡ 0                                 |
|     Â      |        |                                                                     |                                 |                                   | * stack/OOGX    â‰¡ 0                                 |
|     Â      |        |                                                                     |                                 |                                   | .      => XAHOY â‰¡ 0                                 |
|-----------+--------+---------------------------------------------------------------------+---------------------------------+-----------------------------------+-----------------------------------------------------|
|     iÂ     | SCEN   | ï„¦ CALL/entry â‰¡ 1     ðŸ‘‹                                             |                                 |                                   |                                                     |
|     Â      |        | ^^^^^^^^^^^^^^^^                                                    |                                 |                                   |                                                     |
|     Â      |        |                                                                     |                                 |                                   |                                                     |
|     Â      |        | ï„¦ CALL/precompile               <==  callee_is_precompile        ðŸ‘‹ |                                 |                                   |                                                     |
|     Â      |        | ï„¦ CALL/externally_owned_account <==     Â¬ callee_is_precompile      |                                 |                                   |                                                     |
|     Â      |        | .                                     âˆ§ Â¬ callee_has_code        ðŸ‘‹ |                                 |                                   |                                                     |
|     Â      |        | ï„¦ CALL/smart_contract           <==  callee_has_code             ðŸ‘‹ |                                 |                                   |                                                     |
|     Â      |        |                                                                     |                                 |                                   | Impose that:                                        |
|     Â      |        |                                                                     |                                 |                                   | ============                                        |
|     Â      |        |                                                                     |                                 |                                   | .   ï„¦ CALL/EXCEPTION â‰¡ XAHOY                        |
|-----------+--------+---------------------------------------------------------------------+---------------------------------+-----------------------------------+-----------------------------------------------------|
|   i + 1   | CON    | readContextData( current context )                                  |                                 |                                   |                                                     |
|     Â      |        |                                                                     |                                 |                                   |                                                     |
|     Â      |        |                                                                     |                                 |                                   | Provides:                                           |
|     Â      |        |                                                                     |                                 |                                   | =========                                           |
|     Â      |        |                                                                     |                                 |                                   | .   context/IS_STATIC                               |
|     Â      |        |                                                                     |                                 |                                   | .   context/CALL_STACK_DEPTH                        |
|     Â      |        |                                                                     |                                 |                                   | .   context/ACCOUNT_ADDRESS                         |
|-----------+--------+---------------------------------------------------------------------+---------------------------------+-----------------------------------+-----------------------------------------------------|
|   i + 2   | MISC   | misc/OOBðŸš©    â‰¡ is_CALL                                             |                                 |                                   |                                                     |
|     Â      |        | misc/OOB_INST â‰¡ OOB_INST_call     âœ…                                |                                 |                                   |                                                     |
|     Â      |        |                                                                     |                                 |                                   |                                                     |
|     Â      |        |                                                                     |                                 |                                   | Provides:                                           |
|     Â      |        |                                                                     |                                 |                                   | =========                                           |
|     Â      |        |                                                                     |                                 |                                   | * OOB_nonzero_value                                 |
|     Â      |        |                                                                     |                                 |                                   | * OOB_aborting_condition                            |
|     Â      |        |                                                                     |                                 |                                   |                                                     |
|     Â      |        |                                                                     |                                 |                                   | Impose that:                                        |
|     Â      |        |                                                                     |                                 |                                   | ============                                        |
|     Â      |        |                                                                     |                                 |                                   |                                                     |
|     Â      |        |                                                                     |                                 |                                   | .   stack/STATICX â‰¡    is_CALL                      |
|     Â      |        |                                                                     |                                 |                                   | .                    âˆ§ OOB_nonzero_value            |
|     Â      |        |                                                                     |                                 |                                   | .                    âˆ§ context/IS_STATIC            |
|     Â      |        |                                                                     |                                 |                                   | .                 â‰¡  0     âœ…                       |
|     Â      |        |                                                                     |                                 |                                   |                                                     |
|     Â      |        |                                                                     |                                 |                                   | .   ï„¦ CALL/ABORT  â‰¡  OOB_aborting_condition         |
|     Â      |        |                                                                     |                                 |                                   | .                 â‰¡  0     âœ…                       |
|     Â      |        |                                                                     |                                 |                                   |                                                     |
|     Â      |        |                                                                     | misc/MXPðŸš©    â‰¡ 1               |                                   |                                                     |
|     Â      |        |                                                                     | misc/MXP_INST â‰¡ MXP_INST_TYPE_5 |                                   |                                                     |
|     Â      |        |                                                                     |                                 |                                   |                                                     |
|     Â      |        |                                                                     |                                 |                                   | Provides:                                           |
|     Â      |        |                                                                     |                                 |                                   | =========                                           |
|     Â      |        |                                                                     |                                 |                                   | * misc/MXP_MXPX <== MXPX_memory_expansion_exception |
|     Â      |        |                                                                     |                                 |                                   | * misc/MXP_GAS  <== MXPX_memory_expansion_gas       |
|     Â      |        |                                                                     |                                 |                                   |                                                     |
|     Â      |        |                                                                     |                                 |                                   | Impose that:                                        |
|     Â      |        |                                                                     |                                 |                                   | ============                                        |
|     Â      |        |                                                                     |                                 |                                   | .   stack/MXPX â‰¡ MXPX_memory_expansion_exception    |
|     Â      |        |                                                                     |                                 |                                   | .              â‰¡ 0     âœ…                           |
|     Â      |        |                                                                     |                                 |                                   |                                                     |
|     Â      |        |                                                                     |                                 | misc/STPðŸš©    â‰¡ 1                 |                                                     |
|     Â      |        |                                                                     |                                 | misc/STP_INST â‰¡ stack/INSTRUCTION |                                                     |
|     Â      |        |                                                                     |                                 |                                   |                                                     |
|     Â      |        |                                                                     |                                 |                                   | Provides:                                           |
|     Â      |        |                                                                     |                                 |                                   | =========                                           |
|     Â      |        |                                                                     |                                 |                                   | * misc/STP_UPFRONT_GAS_COST                         |
|     Â      |        |                                                                     |                                 |                                   | * misc/STP_OOGX                                     |
|     Â      |        |                                                                     |                                 |                                   | * misc/STP_GAS_POOP                                 |
|     Â      |        |                                                                     |                                 |                                   | * misc/STP_GAS_STPD                                 |
|     Â      |        |                                                                     |                                 |                                   |                                                     |
|     Â      |        |                                                                     |                                 |                                   | Impose that:                                        |
|     Â      |        |                                                                     |                                 |                                   | ============                                        |
|     Â      |        |                                                                     |                                 |                                   | .   stack/OOGX â‰¡ misc/STP_OOGX                      |
|     Â      |        |                                                                     |                                 |                                   | .              â‰¡ 0     âœ…                           |
|     Â      |        |                                                                     |                                 |                                   |                                                     |
|-----------+--------+---------------------------------------------------------------------+---------------------------------+-----------------------------------+-----------------------------------------------------+-----------+-----------|
|   i + 3   | ACC    | load( context/ACCOUNT_ADDRESS )                                     |                                 |                                   |                                                     | Ï„ âˆ™ h + 0 | 0         |
|     Â      |        |                                                                     |                                 |                                   |                                                     |           |           |
|     Â      |        |                                                                     |                                 |                                   | Provides:                                           |           |           |
|     Â      |        |                                                                     |                                 |                                   | =========                                           |           |           |
|     Â      |        |                                                                     |                                 |                                   | * acc/BALANCE                                       |           |           |
|-----------+--------+---------------------------------------------------------------------+---------------------------------+-----------------------------------+-----------------------------------------------------+-----------+-----------|
|   i + 4   | ACC    | acc/TRMðŸš©     â‰¡ 1                         ðŸ‘‹                        |                                 |                                   |                                                     | Ï„ âˆ™ h + 1 | 0         |
|     Â      |        | acc/ROM_LEXðŸš© â‰¡ ï„¦ CALL/smart_contract     ðŸ‘‹                        |                                 |                                   |                                                     |           |           |
|     Â      |        | load( trimmed_target_address )            ðŸ‘‹                        |                                 |                                   |                                                     |           |           |
|     Â      |        |                                                                     |                                 |                                   |                                                     |           |           |
|     Â      |        |                                                                     |                                 |                                   | Provides:                                           |           |           |
|     Â      |        |                                                                     |                                 |                                   | =========                                           |           |           |
|     Â      |        |                                                                     |                                 |                                   | * acc/ADDRESS_HI   (<== trimmed high part)          |           |           |
|     Â      |        |                                                                     |                                 |                                   | * acc/HAS_CODE      <== callee_has_code             |           |           |
|     Â      |        |                                                                     |                                 |                                   | * acc/EXISTS        <== callee_exists               |           |           |
|     Â      |        |                                                                     |                                 |                                   | * acc/IS_PRECOMPILE <== callee_is_precompile        |           |           |
|     Â      |        |                                                                     |                                 |                                   | * If acc/ROM_LEXðŸš© â‰¡ 1: acc/CODE_FRAGMENT_INDEX     |           |           |
|     Â      |        |                                                                     |                                 |                                   | .                   <== callee_cfi                  |           |           |
|-----------+--------+---------------------------------------------------------------------+---------------------------------+-----------------------------------+-----------------------------------------------------+-----------+-----------|


NOTE. We use the following shorthands

        * h â‰¡ HUB_STAMP

NOTE. The above depicts the layout of the first 3 NON_STACK_ROWS of ANY unexceptional, unaborted CALL-type instruction.
The above also depitcts the first set of 2 account-rows (which is present in ALL unexceptional, unaborted CALL-type instruction handlings.)

NOTE. The account-rows that are required to deal with (unexceptional, unaborted) CALL-type instructions are:

    * ï„¦ CALL/externally_owned_account â‰¡ 1:
        - 2 or 4 extra account-rows followed by a context-row
        - the context-row updates (i.e. resets) the current context's return data

    * ï„¦ CALL/smart_contract â‰¡ 1:
        - 2, 4 or 5 account-rows followed by a context-row
        - the context-row INITIALIZES the execution context where execution of the callee will take place;

    * ï„¦ CALL/precompile â‰¡ 1:
        - 2 or 4 account-rows followed by a scenario-row
        - the scenario-row remembers which precompile processing is required:
            âˆ™ ï„¦ PRC/ECRECOVER
            âˆ™ ï„¦ PRC/SHA2-256
            âˆ™ ï„¦ PRC/RIPEMD-160
            âˆ™ ï„¦ PRC/IDENTITY
            âˆ™ ï„¦ PRC/MODEXP
            âˆ™ ï„¦ PRC/ECADD
            âˆ™ ï„¦ PRC/ECMUL
            âˆ™ ï„¦ PRC/ECPAIRING
            âˆ™ ï„¦ PRC/BLAKE2f
        - the scenario-row carries a PREDICTION of which precompile scenario will play out
            âˆ™ ï„¦ PRC/FAILURE_KNOWN_TO_HUB
            âˆ™ ï„¦ PRC/FAILURE_KNOWN_TO_RAM
            âˆ™ ï„¦ PRC/SUCCESS_WILL_REVERT
            âˆ™ ï„¦ PRC/SUCCESS_WONT_REVERT
        - beyond that point the 'second phase of precompile processing' sets in

\end{verbatim}
\end{document}
