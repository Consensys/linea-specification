We impose the following constraints:
\begin{enumerate}
    \item \csCOne{}, \csCTwo{}, \csGOne{}, \csGTwo{} are \textbf{counter-constant, binary} \quad (\trash)
    \item we define them as
        \[
        \left\{ \begin{array}{lcl}
            \csCOne _{i} & = & \malformedDataExternalBit \cdot \isBlsGOneAddData _{i} \\
            \csCTwo _{i} & = & \malformedDataExternalBit \cdot \isBlsGTwoAddData _{i} \\
            \csGOne _{i} & = &
            \left[ \begin{array}{cl}
                + & \locCsGOneForMsm               _{i} \\
                + & \locCsGOneForPairingMalformed  _{i} \\
                + & \locCsGOneForPairingWellformed _{i} \\
            \end{array} \right]
            \vspace{2mm}
            \\
            \csGTwo _{i} & = &
            \left[ \begin{array}{cl}
                + & \locCsGTwoForMsm               _{i} \\
                + & \locCsGTwoForPairingMalformed  _{i} \\
                + & \locCsGTwoForPairingWellformed _{i} \\
            \end{array} \right]
            \\
        \end{array} \right.
        \]
        where we set
        \[
            \left\{ \begin{array}{lcl}
                \locCsGOneForMsm _{i} & \define &
                \left[ \begin{array}{cl}
                    \cdot & \isBlsGOneMsmData         _{i} \\
                    \cdot & \isFirstInput             _{i} \\
                    \cdot & \malformedDataExternalBit _{i} \\
                \end{array} \right]
                \vspace{2mm}
                \\
                \locCsGTwoForMsm _{i} & \define &
                \left[ \begin{array}{cl}
                    \cdot & \isBlsGTwoMsmData         _{i} \\
                    \cdot & \isFirstInput             _{i} \\
                    \cdot & \malformedDataExternalBit _{i} \\
                \end{array} \right]
                \\
            \end{array} \right.
        \]
        and
        \[
            \left\{ \begin{array}{lcl}
                \locCsGOneForPairingMalformed  _{i} & \define &
                \left[ \begin{array}{cl}
                    \cdot & \isBlsPairingCheckData    _{i} \\
                    \cdot & \isFirstInput             _{i} \\
                    \cdot & \malformedDataExternalBit _{i} \\
                \end{array} \right]
                \vspace{2mm}
                \\
                \locCsGTwoForPairingMalformed  _{i} & \define &
                \left[ \begin{array}{cl}
                    \cdot & \isBlsPairingCheckData    _{i} \\
                    \cdot & \isSecondInput            _{i} \\
                    \cdot & \malformedDataExternalBit _{i} \\
                \end{array} \right]
                \\
            \end{array} \right.
        \]
        and
        \[
            \left\{ \begin{array}{lcl}
                \locCsGOneForPairingWellformed _{i} & \define &
                \left[ \begin{array}{cl}
                    \cdot & \isBlsPairingCheckData          _{i}  \\
                    \cdot & \isFirstInput                   _{i}  \\
                    \cdot & (1 - \nontrivialPairOfPointsBit _{i}) \\
                    \cdot & (1 - \isInfinity                _{i}) \\
                    \cdot & \locWellformedData              _{i}  \\
                \end{array} \right]
                \vspace{2mm}
                \\
                \locCsGTwoForPairingWellformed _{i} & \define &
                \left[ \begin{array}{cl}
                    \cdot & \isBlsPairingCheckData          _{i}  \\
                    \cdot & \isSecondInput                  _{i}  \\
                    \cdot & (1 - \nontrivialPairOfPointsBit _{i}) \\
                    \cdot & (1 - \isInfinity                _{i}) \\
                    \cdot & \locWellformedData              _{i}  \\
                \end{array} \right]
            \end{array} \right.
        \]
\end{enumerate}
We now define the behaviour of the various circuit selectors.
\begin{description}
    \item[Circuit selector for the \inst{PointEvaluation} circuit:]
        $\csPointEvaluation _{i} = \locIsPointEvaluation _{i} \cdot \wellformedDataNontrivial _{i}$
    \item[Circuit selector for the \inst{G1ADD} circuit:]
        $\csGOneAdd _{i} = \locIsBlsGOneAdd _{i} \cdot \wellformedDataNontrivial _{i}$
    \item[Circuit selector for the \inst{G1MSM} circuit:]
        $\csGOneMsm _{i} = \locIsBlsGOneMsm _{i} \cdot \wellformedDataNontrivial _{i}$
    \item[Circuit selector for the \inst{G2ADD} circuit:]
        $\csGTwoAdd _{i} = \locIsBlsGTwoAdd _{i} \cdot \wellformedDataNontrivial _{i}$
    \item[Circuit selector for the \inst{G2MSM} circuit:]
        $\csGTwoMsm _{i} = \locIsBlsGTwoMsm _{i} \cdot \wellformedDataNontrivial _{i}$
    \item[Circuit selector for the \inst{PAIRING\_CHECK} circuit:]
        we introduce the following shorthands:
        \[
            \begin{array}{lcl}
                \locCsGOneForPairingMalformed _{i} & \define &
                \left[ \begin{array}{clcr}
                    \cdot & \locIsBlsPairingCheck _{i}     \\
                    \cdot & \malformedDataExternalBit _{i} \\
                    \cdot & \isFirstInput _{i}             \\
                \end{array} \right]
                \vspace{2mm}
                \\
                %
                \locCsGOneForPairingWellformed _{i} & \define &
                \left[ \begin{array}{clcr}
                    \cdot & \locIsBlsPairingCheck _{i}            \\
                    \cdot & \locWellformedData _{i}               \\
                    \cdot & \isFirstInput _{i}                    \\
                    \cdot & (1 - \isInfinity _{i})                \\
                    \cdot & (1 - \nontrivialPairOfPointsBit _{i}) \\
                \end{array} \right]
                \vspace{2mm}
                \\
                %
                \locCsGOneForPairing _{i} & \define &
                \left[ \begin{array}{clcr}
                    + & \locCsGOneForPairingMalformed _{i}  \\
                    + & \locCsGOneForPairingWellformed _{i} \\
                \end{array} \right]
                \vspace{2mm}
                \\
                %
                \locCsGTwoForPairingMalformed _{i} & \define &
                \left[ \begin{array}{clcr}
                    \cdot & \locIsBlsPairingCheck _{i}                        \\
                    \cdot & \malformedDataExternalBit _{i}                            \\
                    \cdot & \isSecondInput _{i}                                \\
                \end{array} \right]
                \vspace{2mm}
                \\
                %
                \locCsGTwoForPairingWellformed _{i} & \define &
                \left[ \begin{array}{clcr}
                    \cdot & \locIsBlsPairingCheck _{i}                        \\
                    \cdot & \locWellformedData _{i}                           \\
                    \cdot & \isSecondInput _{i}                                \\
                    \cdot & (1 - \isInfinity _{i})                            \\
                    \cdot & (1 - \nontrivialPairOfPointsBit _{i})                \\
                \end{array} \right]
                \vspace{2mm}
                \\
                %
                \locCsGTwoForPairing _{i} & \define &
                \left[ \begin{array}{clcr}
                    + & \locCsGTwoForPairingMalformed _{i}                       \\
                    + & \locCsGTwoForPairingWellformed _{i}                      \\
                \end{array} \right]
                \\
            \end{array}
        \]
        we impose the following constraints:
        \begin {enumerate}
    \item
        \[
            \begin{array}{lcl}
                \csPairing _{i} & = & \isBlsPairingCheckData _{i} \cdot \wellformedDataNontrivial _{i} \cdot \nontrivialPairOfPointsBit _{i} \\
                &   & + \isBlsPairingCheckResult _{i} \cdot \wellformedDataNontrivial _{i}                               \\
            \end{array}
        \]
    \item \If $\locIsBlsPairingCheck _{i} = 0$ \Then
        \[
            \begin{array}{lcl}
                \csPairing _{i} & = & 0
            \end{array}
        \]
\end{enumerate}
    \item[Circuit selector for the \inst{C1\_MEMBERSHIP\_TEST} circuit:]
        $\csCOne _{i} = \csCOne _{i}$
    \item[Circuit selector for the \inst{C2\_MEMBERSHIP\_TEST} circuit:]
        $\csCTwo _{i} = \csCTwo _{i}$
    \item[Circuit selector for the \inst{G1\_MEMBERSHIP\_TEST} circuit:]
        % $\csGOne _{i} = \csGOne _{i}$
        we introduce the following shorthands:
        \[
            \begin{array}{lcl}
                \locCsGOneForMsm _{i} & \define &
                \left[ \begin{array}{clcr}
                    % + & \locCsGTwoForPairingMalformed _{i}                       \\
                    % + & \locCsGTwoForPairingWellformed _{i}                      \\
                \end{array} \right] \vspace{2mm}                             \\
            \end{array}
        \]

        we impose the following constraints:
        \[
            \csGOne _{i} =
            \left[ \begin{array}{clcr}
                + & \isBlsPairingCheckData _{i} \cdot \locCsGOneForPairing \\
                + & \isBlsGOneMsmData      _{i} \cdot \locCsGOneForMsm     \\
            \end{array} \right] \vspace{2mm}                             \\
        \]

    \item[Circuit selector for the \inst{G2\_MEMBERSHIP\_TEST} circuit:]
        %$\csGTwo _{i} = \csGTwo _{i}$
        we introduce the following shorthands:
        \[
            \begin{array}{lcl}
                \locCsGTwoForMsm _{i} & \define &
                \left[ \begin{array}{clcr}
                    % + & \locCsGTwoForPairingMalformed _{i}                     \\
                    % + & \locCsGTwoForPairingWellformed _{i}                    \\
                \end{array} \right] \vspace{2mm}                             \\
            \end{array}
        \]

        we impose the following constraints:
        \[
            \csGTwo _{i} =
            \left[ \begin{array}{clcr}
                + & \isBlsPairingCheckData _{i} \cdot \locCsGTwoForPairing \\
                + & \isBlsGTwoMsmData      _{i} \cdot \locCsGTwoForMsm     \\
            \end{array} \right] \vspace{2mm}                             \\
        \]
    \item[Circuit selector for the \inst{MAP\_FP\_TO\_G1} circuit:]
        $\csMapFpToGOne _{i} = \locIsBlsMapFpToGOne _{i} \cdot \wellformedDataNontrivial _{i}$
    \item[Circuit selector for the \inst{MAP\_FP2\_TO\_G2} circuit:]
        $\csMapFpTwoToGTwo _{i} = \locIsBlsMapFpTwoToGTwo _{i} \cdot \wellformedDataNontrivial _{i}$
\end{description}

Note that, at most one of the circuit selectors may light up for a given row:

\begin{enumerate}
    \item
        $\csPointEvaluation _{i}
        + \csCOne _{i}
        + \csGOne _{i}
        + \csCTwo _{i}
        + \csGTwo _{i}
        + \csPairing _{i}
        + \csGOneAdd _{i}
        + \csGTwoAdd _{i}
        + \csGOneMsm _{i}
        + \csGTwoMsm _{i}
        + \csMapFpToGOne _{i}
        + \csMapFpTwoToGTwo _{i}$
        is binary \quad (\trash)
\end{enumerate}
The data that should be read by external circuits are always the following:
\begin{enumerate}
    \item \blsId{}
    \item \blsIndex{}
    \item \blsLimb{}
    \item \blsSuccessBit{}
\end{enumerate}
