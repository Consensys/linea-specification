The present section imposes the behaviour of the various circuit selectors.
\begin{description}
    \item[Circuit selector for the \inst{PointEvaluation} circuit:]
        $\csPointEvaluation_{i} = (1 - \malformedDataInternalJustification_{i}) \cdot \locIsPointEvaluation_{i}$
    \item[Circuit selector for the \inst{G1ADD} circuit:]
        $\csGOneAdd_{i} = (1 - \malformedDataInternalJustification_{i}) \cdot \locIsBlsGOneAdd_{i} \cdot (1 - \malformedDataExternalJustification_{i})$
    \item[Circuit selector for the \inst{G1MSM} circuit:]
        $\csGOneMsm_{i} = (1 - \malformedDataInternalJustification_{i}) \cdot \locIsBlsGOneMsm_{i} \cdot (1 - \malformedDataExternalJustification_{i})$
    \item[Circuit selector for the \inst{G2ADD} circuit:]
        $\csGTwoAdd_{i} = (1 - \malformedDataInternalJustification_{i}) \cdot \locIsBlsGTwoAdd_{i} \cdot (1 - \malformedDataExternalJustification_{i})$
    \item[Circuit selector for the \inst{G2MSM} circuit:]
        $\csGTwoMsm_{i} = (1 - \malformedDataInternalJustification_{i}) \cdot \locIsBlsGTwoMsm_{i} \cdot (1 - \malformedDataExternalJustification_{i})$
    \item[Circuit selector for the \inst{PAIRING\_CHECK} circuit:]
    we impose the following constraints:
        \begin {enumerate}
            \item \If $\isBlsPairingCheckData_{i} = 1$ \Then  
                \[
                    \begin{array}{lcl}
                        \csPairing_{i} & \equiv &
                        \left[ \begin{array}{clcr}
                            \wedge & (1 - \malformedDataInternalJustification_{i})   & \equiv & \texttt{true}  \\
                            \wedge & \malformedDataExternalJustification_{i}          & \equiv & \texttt{false} \\
                            \wedge & \acceptablePairOfPoints_{i} & \equiv & \texttt{true}  \\
                        \end{array} \right] \vspace{2mm} \\
                        & \equiv & 
                        \left[ \begin{array}{clcr}
                            \cdot & (1 - \malformedDataInternalJustification_{i})   \\
                            \cdot & (1 - \malformedDataExternalJustification_{i})  \\
                            \cdot & \acceptablePairOfPoints_{i} \\
                        \end{array} \right] \vspace{2mm} \\
                        & =      & \acceptablePairOfPoints_{i} \\
                    \end{array}
                \]
            \item \If $\isBlsPairingCheckResult_{i} = 1$ \Then
                \[
                    \begin{array}{lcl}
                        \csPairing_{i} & = & \blsSuccessBit_{i} \cdot \locNonTrivial_{i}
                    \end{array}
                \]
            \item \If $\locIsBlsPairingCheck_{i} = 0$ \Then
                \[
                    \begin{array}{lcl}
                        \csPairing_{i} & = & 0
                    \end{array}
                \]
        \end{enumerate}

    
    \item[Circuit selector for the \inst{C1\_MEMBERSHIP\_TEST} circuit:]
        \[
            \begin{array}{lcl}
                \csCOne_{i} & \equiv &
                \left[ \begin{array}{clcr}
                    \wedge & \isBlsPairingCheckData_{i}        & \equiv & \texttt{true} \\
                    \wedge & (1 - \malformedDataInternalJustification_{i})   & \equiv & \texttt{true} \\
                    \wedge & \cOneMembershipTestRequired_{i} & \equiv & \texttt{true} \\
                \end{array} \right] \vspace{2mm} \\
                & \equiv & 
                \left[ \begin{array}{clcr}
                    \cdot & \isBlsPairingCheckData_{i}        \\
                    \cdot & (1 - \malformedDataInternalJustification_{i})   \\
                    \cdot & \cOneMembershipTestRequired_{i} \\
                \end{array} \right] \vspace{2mm} \\
                & =      & \cOneMembershipTestRequired_{i} \\
            \end{array}
        \]
    \noindent
    Similarly:
    \item[Circuit selector for the \inst{C2\_MEMBERSHIP\_TEST} circuit:]
        $\csCTwo_{i} = \cTwoMembershipTestRequired_{i}$
    \item[Circuit selector for the \inst{G1\_MEMBERSHIP\_TEST} circuit:]
        $\csGOne_{i} = \gOneMembershipTestRequired_{i}$
    \item[Circuit selector for the \inst{G2\_MEMBERSHIP\_TEST} circuit:]
        $\csGTwo_{i} = \gTwoMembershipTestRequired_{i}$
    \item[Circuit selector for the \inst{MAP\_FP\_TO\_G1} circuit:]
        $\csMapFpToGOne_{i} = (1 - \malformedDataInternalJustification_{i}) \cdot \locIsBlsMapFpToGOne_{i}$
    \item[Circuit selector for the \inst{MAP\_FP2\_TO\_G2} circuit:]
        $\csMapFpTwoToGTwo_{i} = (1 - \malformedDataInternalJustification_{i}) \cdot \locIsBlsMapFpTwoToGTwo_{i}$
\end{description}    

% TODO: add ADD and MSM cases

Note that, at most one of the circuit selectors may light up for a given row:

\begin{enumerate}
    \item $\csPointEvaluation_{i} + \csCOne_{i} + \csGOne_{i} + \csCTwo_{i} + \csGTwo_{i} + \csPairing_{i} + \csGOneAdd_{i} + \csGTwoAdd_{i} + \csGOneMsm_{i} + \csGTwoMsm_{i} + \csMapFpToGOne_{i} + \csMapFpTwoToGTwo_{i}$ is binary \quad (\trash)
\end{enumerate}
The data that should be read by external circuits are always the following:
\begin{enumerate}
    \item \blsId{}
    \item \blsIndex{}
    \item \blsLimb{}
    \item \blsSuccessBit{}
\end{enumerate}

% \saNote{}
% Whenever $\blsSuccessBit = 0$ then $\csEcpairing = 0$, while if $\blsSuccessBit = 1$ then $\csEcpairing = \acceptablePairOfPoints$.

% \saNote{}
% Given the \blsMod{} is processing \inst{ECPAIRING} instructions, the $\csGTwo$ flag lights up under two circumstances:
% \begin{enumerate} 
% \item $\internalChecksPassed = 1$, $\blsSuccessBit = 0$ along the rows of first large point that is predicted not to lie on the $G_2$ subgroup;
% \item $\internalChecksPassed = 1$, $\blsSuccessBit = 1$ along the rows of the large point of every pair of the form $(\infty, \locB)$;
% \end{enumerate}

